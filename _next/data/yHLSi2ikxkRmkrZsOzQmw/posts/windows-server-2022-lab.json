{"pageProps":{"post":{"slug":"windows-server-2022-lab","title":"Building a Windows Server 2022 Enterprise Lab with Active Directory, Secure Administration, and Automation","date":"2025-08-13","excerpt":"A practical guide to building a Windows Server 2022 lab with AD, RBAC, GPO automation, monitoring, and disaster recovery—powered by PowerShell scripting.","content":"<p>Creating a dedicated Windows Server lab is one of the best ways to simulate real-world enterprise IT infrastructure. This guide walks you through the building of a <strong>Windows Server 2022 lab environment</strong> featuring <strong>Active Directory</strong>, <strong>secure RBAC</strong>, <strong>GPO automation</strong>, <strong>monitoring</strong>, and <strong>disaster recovery</strong>—powered by <strong>PowerShell scripting</strong>.</p>\n<hr>\n<h2>Project Overview</h2>\n<p>This lab demonstrates:</p>\n<ul>\n<li><strong>Windows Server 2022 setup</strong> &#x26; domain configuration</li>\n<li><strong>Active Directory Domain Services (AD DS)</strong> management</li>\n<li><strong>Role-Based Access Control (RBAC)</strong> with least privilege</li>\n<li><strong>Group Policy Object (GPO) automation</strong> via PowerShell</li>\n<li><strong>Real-time monitoring</strong> with alerts</li>\n<li><strong>Disaster recovery simulation</strong> with tested backups</li>\n</ul>\n<hr>\n<h2>Lab Architecture</h2>\n<p><img src=\"https://github.com/letisiapangataa/windows-server-lab/raw/main/architecture/lab-diagram.png\" alt=\"Lab Architecture Diagram\"></p>\n<p><strong>Servers</strong></p>\n<ul>\n<li><strong>DC01</strong> – Domain Controller &#x26; DNS</li>\n<li><strong>FILE01</strong> – File Server</li>\n<li><strong>APP01</strong> – Application Server</li>\n<li><strong>MON01</strong> – Monitoring Server</li>\n<li><strong>BACKUP01</strong> – Backup Server</li>\n</ul>\n<p><strong>Workstations</strong></p>\n<ul>\n<li>WS01, WS02, WS03 – Windows 10/11 clients</li>\n</ul>\n<hr>\n<h2>Key Features with Real Examples</h2>\n<h3>1. Automated User Provisioning</h3>\n<p>Bulk-create users and assign them to OUs with this script:</p>\n<pre><code class=\"language-powershell\"># Import required modules\r\nImport-Module ActiveDirectory\r\n\r\n# Function to generate secure password\r\nfunction New-RandomPassword {\r\n    param([int]$Length = 12)\r\n    $chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&#x26;*\"\r\n    $password = \"\"\r\n    for ($i = 0; $i -lt $Length; $i++) {\r\n        $password += $chars[(Get-Random -Maximum $chars.Length)]\r\n    }\r\n    return $password\r\n}\n</code></pre>\n<p><a href=\"https://github.com/letisiapangataa/windows-server-lab/blob/main/scripts/user-provisioning.ps1\">View Full Script</a></p>\n<hr>\n<h3>2. RBAC Implementation</h3>\n<p>From the included <a href=\"https://github.com/letisiapangataa/windows-server-lab/blob/main/docs/rbac-model.md\">rbac-model.md</a>:</p>\n<ul>\n<li><strong>Domain Admins</strong> → Full control</li>\n<li><strong>Helpdesk</strong> → Password resets, basic user management</li>\n<li><strong>Staff</strong> → Standard user access</li>\n<li><strong>IT Operations</strong> → GPO management, monitoring</li>\n<li>Delegated OU control for Helpdesk</li>\n<li>GPO editing restricted to IT Operations</li>\n</ul>\n<hr>\n<h3>3. Group Policy Automation</h3>\n<p>Automatically create and link security-focused GPOs:</p>\n<pre><code class=\"language-powershell\">function New-GPOIfNotExists {\r\n    param(\r\n        [string]$GPOName,\r\n        [string]$Comment = \"\"\r\n    )\r\n    try {\r\n        $ExistingGPO = Get-GPO -Name $GPOName -ErrorAction Stop\r\n        Write-Log \"GPO already exists: $GPOName\"\r\n        return $ExistingGPO\r\n    } catch {\r\n        Write-Log \"Creating GPO: $GPOName\"\r\n        return New-GPO -Name $GPOName -Comment $Comment\r\n    }\r\n}\n</code></pre>\n<p><a href=\"https://github.com/letisiapangataa/windows-server-lab/blob/main/scripts/gpo-automation.ps1\">View Full Script</a></p>\n<hr>\n<h3>4. Monitoring and Alerts</h3>\n<p>From <a href=\"https://github.com/letisiapangataa/windows-server-lab/blob/main/scripts/monitoring-alert.ps1\">monitoring-alert.ps1</a>:</p>\n<pre><code class=\"language-powershell\"># Function to send email alert\r\nfunction Send-Alert {\r\n    param(\r\n        [string]$Subject,\r\n        [string]$Body,\r\n        [string]$Priority = \"Normal\"\r\n    )\r\n    Send-MailMessage -To $EmailTo -From \"monitor@lab.local\" `\r\n        -Subject $Subject -Body $Body -SmtpServer $SmtpServer `\r\n        -Priority $Priority\r\n}\n</code></pre>\n<p>Paired with Task Scheduler, this script can trigger alerts for:</p>\n<ul>\n<li>Failed logons</li>\n<li>Privilege changes</li>\n<li>Service failures</li>\n</ul>\n<hr>\n<h3>5. Disaster Recovery Simulation</h3>\n<p>From <a href=\"https://github.com/letisiapangataa/windows-server-lab/blob/main/docs/disaster-recovery.md\">disaster-recovery.md</a>:</p>\n<ol>\n<li>Restore <strong>system state backup</strong> using Windows Server Backup.</li>\n<li>Perform <strong>authoritative restore</strong> if AD objects are missing.</li>\n<li>Validate AD replication &#x26; service health.</li>\n<li>Test restores quarterly &#x26; log all actions for audit.</li>\n</ol>\n<hr>\n<h2>Security Best Practices Applied</h2>\n<ul>\n<li><strong>Least Privilege RBAC</strong></li>\n<li><strong>Script-driven user management</strong> to prevent manual errors</li>\n<li><strong>Centralised logging</strong> &#x26; <strong>alerting</strong></li>\n<li><strong>Regular tested backups</strong></li>\n</ul>\n<hr>\n<h2>Getting Started with the Lab</h2>\n<ol>\n<li><strong>Set up VMs</strong> in Hyper-V, VMware, or VirtualBox</li>\n<li><strong>Install Windows Server 2022</strong> &#x26; workstations</li>\n<li><strong>Configure networking</strong> (static IPs for servers, DHCP for clients)</li>\n<li><strong>Deploy AD DS</strong> on DC01 (<code>lab.local</code>)</li>\n<li><strong>Run automation scripts</strong> from <code>/scripts/</code></li>\n<li><strong>Follow monitoring and DR docs</strong> in <code>/docs/</code></li>\n</ol>\n<hr>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://learn.microsoft.com/windows-server\">Microsoft Learn – Windows Server</a></li>\n<li><a href=\"https://learn.microsoft.com/windows-server/identity/ad-ds/plan/security-best-practices\">Active Directory Security Best Practices</a></li>\n<li><a href=\"https://learn.microsoft.com/powershell/\">PowerShell Documentation</a></li>\n</ul>\n","difficulty":"Intermediate"}},"__N_SSG":true}